(()=>{window.ThreadsMediaExtractor=window.ThreadsMediaExtractor||{};window.ThreadsMediaExtractor.extractVideo=function(r,n={}){if(!r)return null;const e=r.src||r.currentSrc||r.querySelector("source")?.src;return!e||e==="about:blank"?null:{url:e,poster:this.extractPoster(r,n),element:r,type:"video"}};window.ThreadsMediaExtractor.extractImage=function(r){if(!r)return null;const n=r.tagName==="IMG"?r:r.querySelector("img");if(!n)return null;const e=n.src||n.getAttribute("data-src");return!e||!e.includes("cdninstagram")&&!e.includes("fbcdn")||n.naturalWidth>0&&(n.naturalWidth<=100||n.naturalHeight<=100)?null:{url:e,thumbnail:e,element:n,type:"image"}};window.ThreadsMediaExtractor.extractPoster=function(r,n={}){const e=n.maxDepth||12;let a=r.poster||"";if(!a){let c=r.parentElement,l=0;for(;c&&l<e&&!a;){const o=c.querySelectorAll("img");for(const i of o){const t=i.src||"";if(!(!t||!t.includes("fbcdn.net")&&!t.includes("cdninstagram"))){if(t.includes(".jpg")&&t.includes("t51.2885")){a=t;break}if(t.includes("fbcdn.net")){a=t;break}t.includes("cdninstagram")&&(a=t)}}c=c.parentElement,l++}}return a};window.ThreadsMediaExtractor.extractFromPost=function(r){if(!r)return{videos:[],images:[]};const n=Array.from(r.querySelectorAll('article, [role="article"]')).filter(i=>i!==r),e=i=>n.some(t=>t.contains(i)),c=Array.from(r.querySelectorAll("video")).filter(i=>!e(i)).map((i,t)=>{const s=this.extractVideo(i);return s?{...s,index:t+1,postContainer:r}:null}).filter(Boolean),o=Array.from(r.querySelectorAll("picture")).filter(i=>!e(i)).map((i,t)=>{const s=this.extractImage(i);return s?{...s,index:t+1,postContainer:r}:null}).filter(Boolean);return{videos:c,images:o}};})();
